<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Justin Henning - Cinematographer</title>
    <link rel="stylesheet" href="style.css?v=19">
    <script src="https://player.vimeo.com/api/player.js"></script>
    <style>
        /* Test page specific styles - experiment here */

        /* Font: Tonka Medium Condensed - only for site title */
        @font-face {
            font-family: 'Tonka';
            src: url('fonts/Tonka-MediumCondensed.woff2') format('woff2'),
                 url('fonts/Tonka-MediumCondensed.woff') format('woff');
            font-weight: 500;
            font-style: normal;
            font-display: swap;
        }

        /* Fix header alignment for two-line title */
        header {
            align-items: flex-start !important;
            padding-top: 24px !important;
        }

        .header-left,
        .header-right {
            padding-top: 0 !important;
        }

        /* Site title styling */
        .header-center h1 {
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            gap: 4px !important;
            line-height: 1 !important;
        }

        .header-center h1 .name {
            font-size: 21.5px !important;
            font-weight: 500 !important;
            letter-spacing: 0.05em !important;
        }

        .header-center h1 .title {
            font-size: 12px !important;
            font-weight: 400 !important;
            letter-spacing: 0.135em !important;
        }

        /* Remove body margins and ensure full bleed */
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            background: #000; /* Ensure black background */
        }

        /* Full-screen immersive layout */
        html {
            scroll-behavior: smooth;
            margin: 0;
            padding: 0;
            background: #000; /* Ensure black background */
        }

        #mainContent {
            scroll-snap-type: y mandatory;
            overflow-y: scroll;
            height: 100vh;
            margin: 0 !important; /* Override style.css margin-top: 100vh */
            padding: 0;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        main {
            margin-top: 0 !important; /* Override style.css - no hero on this page */
        }

        .fullscreen-container {
            /* Remove scroll properties - mainContent handles scrolling */
            margin: 0;
            padding: 0;
        }

        .fullscreen-section {
            position: relative;
            width: 100vw;
            height: 100vh;
            scroll-snap-align: start;
            scroll-snap-stop: always;
            overflow: hidden;
            margin: 0;
            padding: 0;
            left: 0;
            background: #000; /* Black background prevents white flash */
        }

        /* Remove all hover effects - override global styles */
        .fullscreen-section:hover {
            opacity: 1 !important;
        }

        .fullscreen-section a:hover {
            opacity: 1 !important; /* Override global a:hover opacity */
        }

        .fullscreen-section:hover .fullscreen-video-bg,
        .fullscreen-section:hover .fullscreen-text-overlay {
            opacity: 1 !important;
        }

        .fullscreen-video-bg:hover {
            opacity: 1 !important;
            filter: none !important;
        }

        .fullscreen-video-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 1;
            pointer-events: none;
            /* Ensure video always fills container properly */
            min-width: 100%;
            min-height: 100%;
        }

        .fullscreen-text-overlay {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .fullscreen-text-overlay h3 {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) rotate(180deg);
            padding: 0 20px;
            font-size: 48px;
            font-weight: 600;
            margin: 0;
            letter-spacing: 0.05em;
            color: #fff;
            writing-mode: vertical-rl;
            white-space: nowrap;
        }

        .fullscreen-text-overlay p {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            padding: 0 20px;
            font-size: 18px;
            margin: 0;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: #fff;
            writing-mode: vertical-rl;
            white-space: nowrap;
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
            opacity: 0.9;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .fullscreen-section:hover .play-button {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.1);
        }

        .play-button svg {
            width: 20px;
            height: 20px;
            fill: #fff;
            margin-left: 3px;
        }

        .scroll-button-container {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            cursor: pointer;
            transition: opacity 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0;
        }

        .scroll-button-container:hover {
            opacity: 0.6;
        }

        .scroll-button-text {
            color: #fff;
            font-size: 18px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: 400;
            line-height: 1;
        }

        .down-arrow {
            width: 30px;
            height: 30px;
        }

        .down-arrow svg {
            width: 100%;
            height: 100%;
            stroke: #fff;
            fill: none;
            stroke-width: 1;
        }

        /* Mobile responsive */
        /* Mobile: Hide full text, show short text */
        .info-short {
            display: none;
        }

        @media (max-width: 768px) {
            /* Header mobile adjustments */
            .info-full {
                display: none;
            }

            .info-short {
                display: inline;
            }

            header {
                padding: 20px 16px !important;
                display: flex !important;
                flex-wrap: nowrap !important;
                align-items: center !important;
            }

            .header-left,
            .header-right {
                flex: 0 0 auto !important;
                display: block !important; /* Override style.css hiding header-right */
                order: 0 !important;
            }

            .header-left {
                padding-left: 0 !important;
                margin-left: 0 !important;
            }

            .header-right {
                padding-right: 0 !important;
                margin-right: 0 !important;
            }

            .header-center {
                flex: 1 !important;
                text-align: center !important;
                order: 0 !important;
                margin-bottom: 0 !important;
                padding-left: 16px !important;
                padding-right: 16px !important;
            }

            .header-center h1 {
                text-align: center !important;
            }

            /* Show hamburger button on mobile */
            .hamburger-btn {
                display: none;
            }

            @media (max-width: 768px) {
                .hamburger-btn {
                    display: flex;
                    position: absolute;
                    right: 0;
                    top: 50%;
                    transform: translateY(-50%);
                }

                /* Make hamburger icon WHITE on this page (dark background) */
                .hamburger-btn span {
                    background-color: #fff !important;
                }

                /* Keep hamburger black when menu is open */
                body.menu-open .hamburger-btn span {
                    background-color: #000 !important;
                }
            }

            /* Hide Info and Work buttons when modal is open on mobile */
            body.modal-open .header-left,
            body.modal-open .header-right {
                display: none !important;
            }

            /* Ensure header doesn't block modal close button */
            body.modal-open header {
                pointer-events: none !important;
                z-index: 1 !important;
            }

            body.modal-open header .header-center {
                pointer-events: auto;
            }

            .play-button {
                width: 45px;
                height: 45px;
            }

            .play-button svg {
                width: 18px;
                height: 18px;
            }

            .fullscreen-text-overlay h3 {
                font-size: 24px;
                padding: 0 15px;
            }

            .fullscreen-text-overlay p {
                font-size: 12px;
                padding: 0 15px;
            }

            .scroll-button-container {
                bottom: 15px;
                gap: 0;
            }

            .scroll-button-text {
                font-size: 12px;
            }

            .down-arrow {
                width: 24px;
                height: 24px;
            }
        }

        /* Mobile landscape orientation - move button even lower */
        /* Use aspect ratio instead of orientation for better Safari compatibility */
        @media (max-width: 768px) and (max-aspect-ratio: 13/9) {
            .scroll-button-container {
                bottom: 8px;
            }
        }

        /* Additional landscape detection using height */
        @media (max-width: 926px) and (max-height: 428px) {
            .scroll-button-container {
                bottom: 8px;
            }
        }

        /* Mobile landscape - adjust modal video positioning */
        @media (max-width: 926px) and (max-height: 428px) {
            .video-modal {
                align-items: flex-start !important;
                padding-top: 0 !important;
            }

            .modal-content-wrapper {
                padding: 50px 20px 30px !important;
                min-height: auto !important;
            }

            .modal-project-header {
                margin-bottom: 12px !important;
            }

            .video-modal-content {
                margin-bottom: 16px !important;
            }
        }

        /* Hide old grid */
        .project-grid {
            display: none;
        }


        /* Modal Overlay Styles */
        .video-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: none !important;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            overflow-y: auto;
            padding: 40px 0;
        }

        .video-modal.active {
            display: flex !important;
            opacity: 1;
        }

        .modal-content-wrapper {
            width: 80vw;
            max-width: 1400px;
            background: #000;
            padding: 60px;
            position: relative;
            margin: auto;
        }

        .modal-project-header {
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .modal-project-title {
            font-family: 'Tonka', sans-serif;
            font-size: 12px;
            font-weight: 400;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: #fff;
            margin: 0;
        }

        .modal-project-subtitle {
            font-family: 'Tonka', sans-serif;
            font-size: 12px;
            font-weight: 400;
            letter-spacing: 0.1em;
            color: #999;
            margin: 0;
        }

        .video-modal-content {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 41.78%; /* 2.39:1 aspect ratio */
            margin-bottom: 48px;
            background: #000;
        }

        .video-modal-content iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .modal-project-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 64px;
        }

        .modal-details-left,
        .modal-details-right {
            max-width: 75ch;
        }

        .modal-project-details p {
            font-family: 'Tonka', sans-serif;
            font-size: 12px;
            font-weight: 400;
            line-height: 1.8;
            color: #fff;
            margin-bottom: 24px;
        }

        .modal-project-details strong {
            font-weight: 400;
            color: #fff;
        }

        .modal-reviews {
            margin-top: 48px;
        }

        .modal-reviews h3 {
            font-family: 'Tonka', sans-serif;
            font-size: 12px;
            font-weight: 400;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: #fff;
            margin-bottom: 1.5rem;
        }

        .modal-review-links {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .modal-review-link {
            font-family: 'Tonka', sans-serif;
            font-size: 12px;
            font-weight: 400;
            line-height: 1.8;
            color: #fff;
            text-decoration: none;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }

        .modal-review-link:hover {
            opacity: 0.6;
        }

        .modal-review-link::before {
            content: '→';
            flex-shrink: 0;
        }

        .modal-close {
            position: fixed;
            top: 40px;
            right: 40px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            z-index: 10000;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .modal-close:hover {
            opacity: 1;
        }

        .modal-close::before,
        .modal-close::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 30px;
            height: 2px;
            background: #fff;
        }

        .modal-close::before {
            transform: translate(-50%, -50%) rotate(45deg);
        }

        .modal-close::after {
            transform: translate(-50%, -50%) rotate(-45deg);
        }

        @media (max-width: 768px) {
            /* Nuclear option - completely override everything */
            html, body {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }

            #mainContent {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                overflow-y: scroll;
                -webkit-overflow-scrolling: touch;
            }

            .fullscreen-section {
                position: relative;
                width: 100vw;
                height: 100vh;
                min-height: 100vh;
            }

            .fullscreen-video-bg {
                position: absolute !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                object-fit: cover !important;
                min-width: 100% !important;
                min-height: 100% !important;
            }

            .video-modal {
                padding: 0;
                height: calc(var(--vh, 1vh) * 100);
                align-items: flex-start;
            }

            .modal-content-wrapper {
                width: 100vw;
                padding: 80px 20px 60px;
                min-height: calc(var(--vh, 1vh) * 100);
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                box-sizing: border-box;
            }

            .modal-project-header {
                flex-direction: column;
                gap: 8px;
                margin-bottom: 24px;
            }

            .video-modal-content {
                margin-bottom: 32px;
            }

            .modal-project-details {
                grid-template-columns: 1fr;
                gap: 32px;
            }

            .modal-close {
                top: 20px;
                right: 20px;
                width: 44px;
                height: 44px;
                z-index: 99999 !important;
                pointer-events: auto !important;
            }

            .modal-close::before,
            .modal-close::after {
                width: 20px;
                pointer-events: none;
            }
        }
    </style>
</head>
<body>
    <!-- Side nav removed for test page -->

    <!-- Header -->
    <header class="main-header">
        <div class="header-left">
            <a href="work.html" class="nav-link">WORK</a>
        </div>
        <div class="header-center">
            <a href="index.html" class="header-title-link" id="headerTitleLink">
                <h1>
                    <span class="name">JUSTIN HENNING</span>
                    <span class="title">CINEMATOGRAPHER</span>
                </h1>
            </a>
            <!-- Hamburger menu button (mobile only) -->
            <button class="hamburger-btn" id="hamburgerBtn" aria-label="Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div class="header-right">
            <a href="work.html#info" class="nav-link" id="infoLink">
                <span class="info-full">INFORMATION</span>
                <span class="info-short">INFO</span>
            </a>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <nav class="mobile-menu-nav">
            <div class="mobile-menu-section">
                <a href="work.html" class="mobile-menu-btn">WORK</a>
                <a href="work.html#info" class="mobile-menu-btn" id="mobileInfoLink">INFORMATION</a>
            </div>
        </nav>
    </div>

    <!-- Main Content -->
    <main id="mainContent">

        <!-- Full-Screen Sections -->
        <div class="fullscreen-container">

            <!-- Your Lucky Day -->
            <section class="fullscreen-section" data-category="film" id="section-0" data-modal-video="872749030" style="cursor: pointer;">
                <video class="fullscreen-video-bg" muted loop playsinline preload="none" poster="media/posters/your-lucky-day.jpg" data-src="media/previews/your-lucky-day.mp4?v=2">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </div>
                <div class="fullscreen-text-overlay">
                    <h3>YOUR LUCKY DAY</h3>
                    <p>FEATURE FILM</p>
                </div>
            </section>

            <!-- Woodford Reserve -->
            <section class="fullscreen-section" data-category="commercial" id="section-1" data-modal-video="898398761" style="cursor: pointer;">
                <video class="fullscreen-video-bg" muted loop playsinline preload="none" poster="media/posters/woodford-reserve.jpg" data-src="media/previews/woodford-reserve.mp4?v=3">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </div>
                <div class="fullscreen-text-overlay">
                    <h3>WOODFORD RESERVE</h3>
                    <p>Commercial</p>
                </div>
            </section>

            <!-- KIA -->
            <section class="fullscreen-section" data-category="automotive" id="section-2" data-modal-video="913839989" style="cursor: pointer;">
                <video class="fullscreen-video-bg" muted loop playsinline preload="none" poster="media/posters/kia.jpg" data-src="media/previews/kia.mp4?v=4">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </div>
                <div class="fullscreen-text-overlay">
                    <h3>KIA</h3>
                    <p>Automotive</p>
                </div>
            </section>

            <!-- Royal Bank of Canada -->
            <section class="fullscreen-section" data-category="commercial" id="section-3" data-modal-video="891284220" style="cursor: pointer;">
                <video class="fullscreen-video-bg" muted loop playsinline preload="none" poster="media/posters/rbc.jpg" data-src="media/previews/rbc.mp4?v=10">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </div>
                <div class="fullscreen-text-overlay">
                    <h3>ROYAL BANK OF CANADA</h3>
                    <p>Commercial</p>
                </div>
            </section>

            <!-- K&N -->
            <section class="fullscreen-section" data-category="automotive" id="section-4" data-modal-video="523316278" style="cursor: pointer;">
                <video class="fullscreen-video-bg" muted loop playsinline preload="none" poster="media/posters/kn.jpg" data-src="media/previews/kn.mp4?v=2">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </div>
                <div class="fullscreen-text-overlay">
                    <h3>K&N</h3>
                    <p>Automotive</p>
                </div>
            </section>

            <!-- RAM -->
            <section class="fullscreen-section" data-category="automotive" id="section-5" data-modal-video="930752804" style="cursor: pointer;">
                <video class="fullscreen-video-bg" muted loop playsinline preload="none" poster="media/posters/ram.jpg" data-src="media/previews/ram.mp4">
                </video>
                <div class="play-button">
                    <svg viewBox="0 0 24 24">
                        <polygon points="5,3 19,12 5,21"></polygon>
                    </svg>
                </div>
                <div class="fullscreen-text-overlay">
                    <h3>RAM</h3>
                    <p>Automotive</p>
                </div>
            </section>

        </div>
    </main>

    <!-- Scroll Button (Fixed at bottom center) -->
    <div class="scroll-button-container">
        <span class="scroll-button-text">SELECT PROJECTS</span>
        <div class="down-arrow">
            <svg viewBox="0 0 24 24">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        </div>
    </div>

    <!-- Information Page -->
    <div id="infoPage" class="info-page">
        <div class="info-content">
            <!-- Biography Section with Photo -->
            <div class="info-row">
                <div class="info-label">
                    <h2>Biography</h2>
                </div>
                <div class="info-detail">
                    <div class="info-image">
                        <img src="media/info-bts.webp" alt="Justin Henning on set">
                    </div>
                    <p>Justin T Henning is an accomplished ICG Local 600 Cinematographer based in Brooklyn, NY. He specializes in feature films and commercial projects, bringing a distinct visual sensibility and emotional depth to every production.</p>
                </div>
            </div>

            <!-- Contact Section -->
            <div class="info-row">
                <div class="info-label">
                    <h2>Contact</h2>
                </div>
                <div class="info-detail">
                    <div class="contact-columns">
                        <div class="contact-column">
                            <div class="contact-item">
                                <p class="contact-title">US / WPA USA</p>
                                <p>Phone: <a href="tel:+13106599965">(310) 659-9965</a></p>
                                <p>Email: <a href="mailto:steven@wp-a.com">steven@wp-a.com</a></p>
                            </div>
                        </div>
                        <div class="contact-column">
                            <div class="contact-item">
                                <p class="contact-title">Personal Contact</p>
                                <p>Email: <a href="mailto:henning.justin@gmail.com">henning.justin@gmail.com</a></p>
                                <p>Instagram: <a href="https://instagram.com/justinthenning" target="_blank">@justinthenning</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer Row -->
            <div class="info-footer">
                <div class="footer-links">
                    <a href="https://www.instagram.com/justinthenning/" target="_blank" class="social-btn">INSTAGRAM</a>
                    <a href="archive.html" class="social-btn">ARCHIVE</a>
                </div>
                <div class="footer-credit">
                    <p>Typeface: Tonka by Céline Hurka and Huw Williams</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Modal -->
    <div class="video-modal" id="videoModal">
        <div class="modal-close" id="modalClose"></div>
        <div class="modal-content-wrapper">
            <!-- Project Header -->
            <div class="modal-project-header">
                <h2 class="modal-project-title" id="modalProjectTitle"></h2>
                <p class="modal-project-subtitle" id="modalProjectSubtitle"></p>
            </div>

            <!-- Video Player -->
            <div class="video-modal-content" id="modalVideoContainer">
                <!-- iframe will be created dynamically to prevent history pollution -->
            </div>

            <!-- Project Details -->
            <div class="modal-project-details">
                <div class="modal-details-left">
                    <p id="modalDirector"></p>
                    <p id="modalProducer"></p>
                    <p id="modalSynopsis"></p>
                    <p id="modalCast"></p>
                </div>
                <div class="modal-details-right">
                    <p id="modalPremiere"></p>
                    <p id="modalDistributor"></p>
                    <p id="modalPlatform"></p>
                </div>
            </div>

            <!-- Reviews Section -->
            <div class="modal-reviews" id="modalReviews" style="display: none;">
                <h3>Reviews</h3>
                <div class="modal-review-links" id="modalReviewLinks">
                </div>
            </div>
        </div>
    </div>

    <!-- <script src="script.js?v=7"></script> -->

    <script>
        // Fix iOS Safari viewport height issue
        function setViewportHeight() {
            // Try multiple methods to get the real screen height
            const methods = {
                visualViewport: window.visualViewport?.height,
                innerHeight: window.innerHeight,
                screenHeight: window.screen.height,
                screenAvailHeight: window.screen.availHeight,
                clientHeight: document.documentElement.clientHeight
            };

            console.log('All height measurements:', methods);

            // Use the LARGER of innerHeight and a safe minimum to ensure coverage
            // Add extra pixels to account for browser UI chrome
            const actualHeight = Math.max(methods.innerHeight, methods.screenAvailHeight * 0.85);

            const vh = actualHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);

            // Set sections AND containers directly via JavaScript on mobile
            if (window.innerWidth <= 768) {
                // Force html, body, and mainContent to use actual screen height
                document.documentElement.style.height = `${actualHeight}px`;
                document.body.style.height = `${actualHeight}px`;
                const mainContent = document.getElementById('mainContent');
                if (mainContent) {
                    mainContent.style.height = `${actualHeight}px`;
                }

                // Set each section to actual screen height
                document.querySelectorAll('.fullscreen-section').forEach(section => {
                    section.style.height = `${actualHeight}px`;
                    section.style.minHeight = `${actualHeight}px`;

                    // Also force the video inside to fill the full height
                    const video = section.querySelector('.fullscreen-video-bg');
                    if (video) {
                        video.style.position = 'absolute';
                        video.style.top = '0';
                        video.style.left = '0';
                        video.style.width = '100vw';
                        video.style.height = `${actualHeight}px`;
                        video.style.minHeight = `${actualHeight}px`;
                        video.style.minWidth = '100vw';
                        video.style.maxWidth = 'none';
                        video.style.maxHeight = 'none';
                        video.style.objectFit = 'cover';
                    }
                });
            }

            console.log('Using height:', actualHeight);
        }

        // Set on load and resize
        setViewportHeight();
        window.addEventListener('resize', setViewportHeight);
        window.addEventListener('orientationchange', setViewportHeight);

        // Listen to visualViewport changes (iOS Safari)
        if (window.visualViewport) {
            window.visualViewport.addEventListener('resize', setViewportHeight);
            window.visualViewport.addEventListener('scroll', setViewportHeight);
        }

        // Force recalculation after delays (iOS Safari needs this)
        setTimeout(setViewportHeight, 100);
        setTimeout(setViewportHeight, 500);
        setTimeout(setViewportHeight, 1000);

        // Simple modal with browser back button support
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded - Script starting...');

            // Ensure viewport height is set
            setViewportHeight();

            // CLEAN UP: If page loaded with modal state, clear it
            if (window.location.search.includes('modal=')) {
                console.log('Cleaning up modal state from URL');
                window.location.replace(window.location.pathname);
                return;
            }

            // Info page handlers
            // Info link navigates to index.html#info (no JavaScript handling needed)

            const modal = document.getElementById('videoModal');
            const modalClose = document.getElementById('modalClose');
            const modalVideoContainer = document.getElementById('modalVideoContainer');
            console.log('Modal elements found:', {modal, modalClose, modalVideoContainer});
            let modalIsOpen = false;
            let currentIframe = null;

            // Project data for Your Lucky Day
            const projectData = {
                '872749030': {
                    title: 'YOUR LUCKY DAY',
                    subtitle: 'Feature Film',
                    director: 'Dan Brown',
                    producer: 'Luke Barnett, Adam Baxter, Daniel Brown',
                    synopsis: 'A dispute over a winning lottery ticket escalates into a deadly hostage situation. The witnesses must decide how far they\'ll go—and how much blood they\'re willing to spill—for a cut of the $156 million prize.',
                    cast: 'Angus Cloud, Elliot Knight, Jessica Garza, Sterling Beaumon, Mousa Hussein Kraish, Jason Wiles, Sebastian Sozzi, Spencer Garrett, Jason O\'Mara',
                    premiere: 'September 23, 2023 at Fantastic Fest',
                    distributor: 'Well Go USA Entertainment',
                    platform: 'Netflix',
                    reviews: [
                        { name: 'Spectrum Culture Review', url: 'https://spectrumculture.com/2023/11/13/your-lucky-day-review/' },
                        { name: 'Roger Ebert Review', url: 'https://www.rogerebert.com/reviews/your-lucky-day-movie-review-2023' },
                        { name: 'Bloody Disgusting Review', url: 'https://bloody-disgusting.com/movie/3782759/your-lucky-day-trailer-lottery-hostage-scenario-gets-intense-in-angus-cloud-starring-thriller/' },
                        { name: 'CrypticRock Review', url: 'https://crypticrock.com/your-lucky-day-movie-review/' },
                        { name: 'Entertainment Weekly', url: 'https://ew.com/movies/angus-cloud-your-lucky-day-trailer/' }
                    ]
                },
                '898398761': {
                    title: 'WOODFORD RESERVE',
                    subtitle: 'The Derby',
                    director: 'David Holm'
                },
                '913839989': {
                    title: 'KIA',
                    subtitle: 'The Good Life',
                    director: 'Brent Foster'
                },
                '891284220': {
                    title: 'ROYAL BANK OF CANADA',
                    subtitle: 'Windy',
                    director: 'David Holm',
                    cast: 'Sahith Theegala, Cameron Young, Sam Burns'
                },
                '523316278': {
                    title: 'K&N',
                    subtitle: 'Filtration for the Future',
                    director: 'Miko Lim'
                },
                '930752804': {
                    title: 'RAM',
                    subtitle: 'Paramotor',
                    director: 'David Holm'
                }
            };

            // Open modal
            function openModal(vimeoId) {
                console.log('openModal called with vimeoId:', vimeoId);
                modal.classList.add('active');
                document.body.classList.add('modal-open');
                document.body.style.overflow = 'hidden';

                // Populate project information if available
                const project = projectData[vimeoId];
                console.log('Project data found:', project);
                if (project) {
                    document.getElementById('modalProjectTitle').textContent = project.title || '';
                    document.getElementById('modalProjectSubtitle').textContent = project.subtitle || '';
                    document.getElementById('modalDirector').innerHTML = project.director ? `<strong>Director:</strong> ${project.director}` : '';
                    document.getElementById('modalProducer').innerHTML = project.producer ? `<strong>Produced by:</strong> ${project.producer}` : '';
                    document.getElementById('modalSynopsis').innerHTML = project.synopsis ? `<strong>Synopsis:</strong> ${project.synopsis}` : '';
                    document.getElementById('modalCast').innerHTML = project.cast ? `<strong>Cast:</strong> ${project.cast}` : '';
                    document.getElementById('modalPremiere').innerHTML = project.premiere ? `<strong>Premiere:</strong> ${project.premiere}` : '';
                    document.getElementById('modalDistributor').innerHTML = project.distributor ? `<strong>Distributed by:</strong> ${project.distributor}` : '';
                    document.getElementById('modalPlatform').innerHTML = project.platform ? `<strong>Platform:</strong> ${project.platform}` : '';

                    // Populate reviews if available
                    const modalReviews = document.getElementById('modalReviews');
                    const modalReviewLinks = document.getElementById('modalReviewLinks');
                    console.log('Reviews check:', {
                        hasReviews: !!project.reviews,
                        reviewCount: project.reviews ? project.reviews.length : 0,
                        modalReviewsElement: !!modalReviews,
                        modalReviewLinksElement: !!modalReviewLinks
                    });
                    if (project.reviews && project.reviews.length > 0) {
                        modalReviewLinks.innerHTML = '';
                        project.reviews.forEach(review => {
                            const link = document.createElement('a');
                            link.href = review.url;
                            link.target = '_blank';
                            link.rel = 'noopener noreferrer';
                            link.className = 'modal-review-link';
                            link.textContent = review.name;
                            modalReviewLinks.appendChild(link);
                        });
                        modalReviews.style.display = 'block';
                        console.log('Reviews displayed:', project.reviews.length);
                    } else {
                        modalReviews.style.display = 'none';
                        console.log('No reviews to display');
                    }
                }

                // Create new iframe (prevents history pollution from previous iframe)
                currentIframe = document.createElement('iframe');
                currentIframe.id = 'modalVideoFrame';
                currentIframe.setAttribute('frameborder', '0');
                currentIframe.setAttribute('allow', 'autoplay; fullscreen; picture-in-picture');
                currentIframe.setAttribute('allowfullscreen', '');
                // Start muted for autoplay to work on mobile, then unmute via Vimeo Player SDK
                currentIframe.src = `https://player.vimeo.com/video/${vimeoId}?autoplay=1&muted=1&title=0&byline=0&portrait=0`;
                modalVideoContainer.appendChild(currentIframe);

                // Use Vimeo Player SDK to unmute
                setTimeout(() => {
                    if (typeof Vimeo !== 'undefined') {
                        const player = new Vimeo.Player(currentIframe);

                        // Wait for player to be ready
                        player.ready().then(() => {
                            console.log('Vimeo player ready');

                            // Set volume to full
                            player.setVolume(1).then(() => {
                                console.log('Volume set to 1 (unmuted)');
                            }).catch((error) => {
                                console.error('Error setting volume:', error);
                            });
                        });
                    } else {
                        console.error('Vimeo Player SDK not loaded');
                    }
                }, 100);

                modalIsOpen = true;

                // Push unique history state for back button support
                const timestamp = Date.now();
                const uniqueUrl = `${window.location.pathname}?modal=${timestamp}`;
                history.pushState({ modal: true, timestamp: timestamp }, '', uniqueUrl);
            }

            // Close modal
            function closeModal() {
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
                document.body.style.overflow = '';

                // Destroy iframe completely to remove all its history entries
                if (currentIframe) {
                    currentIframe.src = '';
                    modalVideoContainer.removeChild(currentIframe);
                    currentIframe = null;
                }

                modalIsOpen = false;
            }

            // Click to open modal
            const modalElements = document.querySelectorAll('[data-modal-video]');
            console.log('Found modal elements:', modalElements.length);

            modalElements.forEach(el => {
                console.log('Attaching click handler to:', el.id, 'with vimeoId:', el.dataset.modalVideo);
                el.addEventListener('click', function(e) {
                    console.log('Section clicked!', this.dataset.modalVideo);
                    // Don't open modal if clicking scroll button
                    if (!e.target.closest('.scroll-button-container')) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('Opening modal with vimeoId:', this.dataset.modalVideo);
                        openModal(this.dataset.modalVideo);
                    }
                });
            });

            // Close button
            modalClose.addEventListener('click', (e) => {
                console.log('Close button clicked!', modalIsOpen);
                e.preventDefault();
                e.stopPropagation();
                if (modalIsOpen) {
                    history.back(); // This will trigger popstate
                }
            });

            // Also add touch event for mobile
            modalClose.addEventListener('touchend', (e) => {
                console.log('Close button touched!', modalIsOpen);
                e.preventDefault();
                e.stopPropagation();
                if (modalIsOpen) {
                    history.back(); // This will trigger popstate
                }
            });

            // Click outside (on modal overlay background, not on content wrapper)
            modal.addEventListener('click', (e) => {
                if ((e.target === modal || e.target.classList.contains('video-modal')) && modalIsOpen) {
                    history.back(); // This will trigger popstate
                }
            });

            // ESC key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modalIsOpen) {
                    history.back(); // This will trigger popstate
                }
            });

            // Browser back button support
            window.addEventListener('popstate', (e) => {
                if (modalIsOpen) {
                    closeModal();
                }
            });

            // Scroll button navigation - find currently visible section and scroll to next
            let currentSectionIndex = 0;
            const sections = document.querySelectorAll('.fullscreen-section');
            const totalSections = sections.length;
            const scrollButton = document.querySelector('.scroll-button-container');

            // Track current section with Intersection Observer
            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const sectionId = entry.target.id;
                        const match = sectionId.match(/section-(\d+)/);
                        if (match) {
                            currentSectionIndex = parseInt(match[1]);

                            // Hide scroll button on last section
                            if (currentSectionIndex === totalSections - 1) {
                                scrollButton.style.display = 'none';
                            } else {
                                scrollButton.style.display = 'flex';
                            }
                        }
                    }
                });
            }, {
                threshold: 0.5
            });

            sections.forEach(section => {
                sectionObserver.observe(section);
            });

            // Scroll button click handler
            scrollButton.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const nextIndex = currentSectionIndex + 1;
                const nextSection = document.getElementById('section-' + nextIndex);
                if (nextSection) {
                    nextSection.scrollIntoView({ behavior: 'smooth' });
                }
            });

            // Intersection Observer for video autoplay
            const videos = document.querySelectorAll('.fullscreen-video-bg');
            console.log('Found videos:', videos.length);

            const videoObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const video = entry.target;
                    console.log('Video intersection:', entry.isIntersecting, video.dataset.src);

                    if (entry.isIntersecting) {
                        // Load video if not loaded yet
                        if (video.dataset.src && !video.src) {
                            console.log('Loading video:', video.dataset.src);
                            video.src = video.dataset.src;
                            video.load();
                        }
                        // Play video when in view
                        video.play().then(() => {
                            console.log('Video playing:', video.dataset.src);
                        }).catch(err => {
                            console.log('Autoplay prevented:', err);
                        });
                    } else {
                        // Pause video when out of view
                        video.pause();
                        console.log('Video paused');
                    }
                });
            }, {
                threshold: 0.5 // Video needs to be 50% visible to play
            });

            // Observe all videos
            videos.forEach(video => {
                console.log('Observing video:', video);
                videoObserver.observe(video);
            });

            // Handle orientation change for mobile
            let orientationTimeout;
            const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

            const handleOrientationChange = () => {
                console.log('Orientation changed, Safari:', isSafari);
                clearTimeout(orientationTimeout);

                orientationTimeout = setTimeout(() => {
                    console.log('Handling orientation change...');

                    // Force re-layout of fullscreen sections
                    const actualHeight = window.innerHeight;
                    const actualWidth = window.innerWidth;

                    document.querySelectorAll('.fullscreen-section').forEach(section => {
                        section.style.height = `${actualHeight}px`;
                        section.style.minHeight = `${actualHeight}px`;
                        section.style.width = `${actualWidth}px`;

                        const video = section.querySelector('.fullscreen-video-bg');
                        if (video) {
                            // Safari-specific: Force complete recalculation by removing and re-adding styles
                            if (isSafari) {
                                // Temporarily remove objectFit to force recalc
                                video.style.objectFit = 'none';
                                video.style.width = 'auto';
                                video.style.height = 'auto';

                                // Force reflow
                                void video.offsetHeight;

                                // Reapply correct styles
                                setTimeout(() => {
                                    video.style.position = 'absolute';
                                    video.style.top = '0';
                                    video.style.left = '0';
                                    video.style.width = '100%';
                                    video.style.height = '100%';
                                    video.style.objectFit = 'cover';
                                    video.style.minWidth = '100%';
                                    video.style.minHeight = '100%';
                                }, 10);
                            } else {
                                // Chrome - simpler approach
                                video.style.width = '100%';
                                video.style.height = '100%';
                                video.style.objectFit = 'cover';
                            }
                        }
                    });

                    // For Safari, don't disconnect observer - just refresh videos
                    if (!isSafari) {
                        videoObserver.disconnect();
                    }

                    // Restart all visible videos
                    videos.forEach(video => {
                        const rect = video.getBoundingClientRect();
                        const isVisible = (
                            rect.top < window.innerHeight &&
                            rect.bottom > 0 &&
                            rect.left < window.innerWidth &&
                            rect.right > 0
                        );

                        if (isVisible) {
                            // Load video if needed
                            if (video.dataset.src && !video.src) {
                                video.src = video.dataset.src;
                                video.load();
                            }

                            // For Safari, wait a bit longer and try multiple times
                            if (isSafari) {
                                // First attempt immediately
                                video.play().catch(() => {
                                    // Second attempt after 100ms
                                    setTimeout(() => {
                                        video.play().catch(() => {
                                            // Third attempt after 200ms
                                            setTimeout(() => {
                                                video.play().then(() => {
                                                    console.log('Video playing on Safari after retry');
                                                }).catch(err => {
                                                    console.log('Safari autoplay blocked:', err);
                                                });
                                            }, 200);
                                        });
                                    }, 100);
                                });
                            } else {
                                // Chrome - single attempt
                                video.play().then(() => {
                                    console.log('Video restarted after orientation change');
                                }).catch(err => {
                                    console.log('Video autoplay prevented after orientation:', err);
                                });
                            }
                        }

                        // Re-observe video (only if we disconnected)
                        if (!isSafari) {
                            videoObserver.observe(video);
                        }
                    });
                }, isSafari ? 500 : 300); // Safari needs more time
            };

            window.addEventListener('orientationchange', handleOrientationChange);

            // Also handle resize events (some browsers fire this instead)
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    // Only trigger on mobile
                    if (window.innerWidth <= 768) {
                        handleOrientationChange();
                    }
                }, 300);
            });

            // Mobile Menu Functionality
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileInfoLink = document.getElementById('mobileInfoLink');

            if (hamburgerBtn && mobileMenu) {
                // Toggle mobile menu
                hamburgerBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const isOpening = !mobileMenu.classList.contains('active');
                    mobileMenu.classList.toggle('active');
                    hamburgerBtn.classList.toggle('active');
                    document.body.classList.toggle('menu-open');

                    // Prevent body scroll when menu is open
                    if (isOpening) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = '';
                    }
                });

                // Close mobile menu when clicking outside
                document.addEventListener('click', (e) => {
                    if (mobileMenu.classList.contains('active') &&
                        !mobileMenu.contains(e.target) &&
                        !hamburgerBtn.contains(e.target)) {
                        mobileMenu.classList.remove('active');
                        hamburgerBtn.classList.remove('active');
                        document.body.classList.remove('menu-open');
                        document.body.style.overflow = '';
                    }
                });
            }
        });
    </script>
</body>
</html>
